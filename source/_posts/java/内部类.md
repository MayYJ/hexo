---
title: 内部类
date: 2018-02-26 00:05:00
tags: 内部类
categories: java
---

#### 内部类

使用内部类的原因：

1. 内部类的方法可以访问该类定义所在的作用域中的数据，包括私有的数据；
2. 内部类可以对同一个包中的其他类隐藏依赖；
3. 当想要定义一个回调函数且不想编写大量代码的时候，使用匿名内部类比较便捷

- 使用内部类访问对象的状态

  就是内部类隐式的含有一个外部类的指针，所以可以访问创建她的外围类对象的数据域

- 内部类的特殊语法规则

  1. 引用外围对象的变量

     虽然我们在内部类可以直接使用变量名来直接使用，但是正规语法要复杂一些：

     ```
     OuterClass.this.变量名  比如：TalkingClock.this.beep

     ```

  2. 构造内部类

     ```
     TalkingClock jabberer = new TalkingClock(...);
     TalkingClock.TimePrinter listener = jabber.new TimePrinter();

     ```

  3. 内部类中声明的所有静态域都必须是final的，原因就是我们希望一个静态域只有一个实例，不过对于每个外部对象，会分别有一个单独的内部类实例；也就是说我们希望每个外围对象都有一个特定的内部类实例。

- 关于内部类的一些讨论

  内部类是一个编译器现象，与虚拟机无关，编译器会把所有内部类翻译成用$分隔开外部类名与内部类型的常规文件，而虚拟机对此一无所知；下面是一个Demo

  ```
  public class TalkingClock$TimePrinter{
    public TalkingClock$TImePrinter(TalkingClock);
    
    public void actionPerformed(ActionEvent);
    
    final TalkingClock this$0;
  }

  ```

  上面的Demo就说明 内部类只是通过构造器初始化了一个外围类；然后通过this$0指向外围类；

- 可以在方法中使用局部内部类

- 匿名内部类: 在现在我的理解就是实例化一个只有一个方法的接口；现在完全可以用lambda表达式替代；

- 静态内部类：

  - 使用原因：有时候内部类只是为了把一个类隐藏在另外一个类的内部，并不需要内部类引用外围类的对象。
  - 也就是你只是临时想给外围类提供一个对象用于存储一些变量的时候可以使用静态内部类；